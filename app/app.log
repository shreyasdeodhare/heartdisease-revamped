2025-10-25 18:26:05,734 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:28:48,983 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:29:55,458 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:30:45,421 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:44:02,126 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:46:32,041 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:46:32,043 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 18:46:32,044 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 18:46:32,045 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 18:46:32,045 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 18:46:32,045 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 18:46:32,045 - heart_disease_prediction - ERROR - Error in load_data: 'DataConfig' object has no attribute 'data_url'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 36, in load_data
    data_url = data_url or config.data.data_url
                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataConfig' object has no attribute 'data_url'
2025-10-25 18:46:32,056 - heart_disease_prediction - ERROR - Unexpected data error: 'DataConfig' object has no attribute 'data_url'
2025-10-25 18:46:32,056 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: 'DataConfig' object has no attribute 'data_url'
2025-10-25 18:46:32,056 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: 'DataConfig' object has no attribute 'data_url'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 36, in load_data
    data_url = data_url or config.data.data_url
                           ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataConfig' object has no attribute 'data_url'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 51, in run_complete_pipeline
    df = self.data_service.load_data()
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'DataConfig' object has no attribute 'data_url'
2025-10-25 18:46:32,062 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'DataConfig' object has no attribute 'data_url'
2025-10-25 18:50:30,203 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:50:30,205 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 18:50:30,205 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 18:50:30,205 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 18:50:30,205 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 18:50:30,206 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 18:50:30,206 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 18:50:30,206 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 18:50:40,381 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 18:50:40,381 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 18:50:42,074 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 18:50:42,075 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 18:50:42,383 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 18:50:42,389 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 18:50:42,389 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 18:50:42,389 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 18:50:42,390 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 18:50:42,390 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 18:50:42,390 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 18:50:42,432 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 18:50:42,432 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 18:50:43,286 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 18:50:43,287 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 18:50:43,287 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 18:50:43,684 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 18:50:43,684 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 18:50:43,684 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 18:50:43,684 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 18:50:43,684 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 18:50:44,043 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 18:50:44,044 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 18:50:44,044 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 18:50:44,241 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 18:50:44,242 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 18:50:44,414 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 18:50:44,414 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 18:50:44,543 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 18:50:44,543 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 18:50:44,674 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 18:50:44,675 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 18:50:44,822 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 18:50:44,823 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 18:50:44,955 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 18:50:44,956 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 18:50:45,082 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 18:50:45,083 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 18:50:45,233 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 18:50:45,233 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 18:50:45,346 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 18:50:45,347 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 18:50:45,455 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 18:50:45,455 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 18:50:45,584 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 18:50:45,585 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 18:50:45,692 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 18:50:45,693 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 18:50:45,825 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 18:50:45,826 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 18:50:45,953 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 18:50:45,954 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 18:50:46,102 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 18:50:46,102 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 18:50:46,102 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 18:50:46,103 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 18:50:46,103 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 18:50:46,103 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 18:50:46,103 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 18:50:46,103 - heart_disease_prediction - ERROR - Error in plot_target_distribution: 'VisualizationConfig' object has no attribute 'figure_size_large'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 68, in plot_target_distribution
    fig, axes = plt.subplots(2, 2, figsize=config.visualization.figure_size_large)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,112 - heart_disease_prediction - ERROR - Unexpected data error: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,112 - heart_disease_prediction - ERROR - Error in generate_comprehensive_report: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 68, in plot_target_distribution
    fig, axes = plt.subplots(2, 2, figsize=config.visualization.figure_size_large)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'figure_size_large'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 322, in generate_comprehensive_report
    self.plot_target_distribution(df, output_dir)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,118 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,118 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,118 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 68, in plot_target_distribution
    fig, axes = plt.subplots(2, 2, figsize=config.visualization.figure_size_large)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'figure_size_large'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 322, in generate_comprehensive_report
    self.plot_target_distribution(df, output_dir)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 56, in run_complete_pipeline
    self.eda_service.generate_comprehensive_report(df_encoded, config.data.OUTPUT_DIR)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:50:46,125 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'figure_size_large'
2025-10-25 18:53:06,167 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:53:06,171 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 18:53:06,171 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 18:53:06,173 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 18:53:06,173 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 18:53:06,173 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 18:53:06,173 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 18:53:06,174 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 18:53:14,544 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 18:53:14,544 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 18:53:16,747 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 18:53:16,747 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 18:53:17,107 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 18:53:17,117 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 18:53:17,117 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 18:53:17,117 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 18:53:17,118 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 18:53:17,118 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 18:53:17,118 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 18:53:17,177 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 18:53:17,177 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 18:53:17,819 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 18:53:17,819 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 18:53:17,820 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 18:53:18,214 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 18:53:18,214 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 18:53:18,215 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 18:53:18,215 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 18:53:18,215 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 18:53:18,613 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 18:53:18,613 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 18:53:18,613 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 18:53:18,738 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 18:53:18,739 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 18:53:18,873 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 18:53:18,874 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 18:53:19,035 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 18:53:19,036 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 18:53:19,209 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 18:53:19,210 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 18:53:19,331 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 18:53:19,331 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 18:53:19,440 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 18:53:19,441 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 18:53:19,565 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 18:53:19,566 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 18:53:19,713 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 18:53:19,714 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 18:53:19,832 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 18:53:19,833 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 18:53:19,943 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 18:53:19,943 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 18:53:20,064 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 18:53:20,064 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 18:53:20,227 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 18:53:20,227 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 18:53:20,381 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 18:53:20,381 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 18:53:20,518 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 18:53:20,518 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 18:53:20,648 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 18:53:20,649 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 18:53:30,249 - heart_disease_prediction - ERROR - Error in plot_target_distribution: 'VisualizationConfig' object has no attribute 'dpi'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 98, in plot_target_distribution
    plt.savefig(os.path.join(output_dir, 'target_distribution.png'), dpi=config.visualization.dpi, bbox_inches='tight')
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'dpi'. Did you mean: 'DPI'?
2025-10-25 18:53:30,277 - heart_disease_prediction - ERROR - Unexpected data error: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:53:30,278 - heart_disease_prediction - ERROR - Error in generate_comprehensive_report: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 98, in plot_target_distribution
    plt.savefig(os.path.join(output_dir, 'target_distribution.png'), dpi=config.visualization.dpi, bbox_inches='tight')
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'dpi'. Did you mean: 'DPI'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 322, in generate_comprehensive_report
    self.plot_target_distribution(df, output_dir)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:53:30,287 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:53:30,288 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:53:30,288 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 98, in plot_target_distribution
    plt.savefig(os.path.join(output_dir, 'target_distribution.png'), dpi=config.visualization.dpi, bbox_inches='tight')
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VisualizationConfig' object has no attribute 'dpi'. Did you mean: 'DPI'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\eda_service.py", line 322, in generate_comprehensive_report
    self.plot_target_distribution(df, output_dir)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 56, in run_complete_pipeline
    self.eda_service.generate_comprehensive_report(df_encoded, config.data.OUTPUT_DIR)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:53:30,511 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: Data processing failed: 'VisualizationConfig' object has no attribute 'dpi'
2025-10-25 18:58:13,701 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 18:58:13,703 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 18:58:13,704 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 18:58:22,145 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 18:58:22,146 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 18:58:23,699 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 18:58:23,699 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 18:58:24,693 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 18:58:24,704 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 18:58:24,704 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 18:58:24,705 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 18:58:24,705 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 18:58:24,705 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 18:58:24,705 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 18:58:24,783 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 18:58:24,783 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 18:58:25,811 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 18:58:25,812 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 18:58:25,812 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 18:58:26,339 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 18:58:26,339 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 18:58:26,340 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 18:58:26,340 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 18:58:26,340 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 18:58:26,928 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 18:58:26,928 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 18:58:26,929 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 18:58:27,196 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 18:58:27,196 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 18:58:27,375 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 18:58:27,375 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 18:58:27,564 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 18:58:27,565 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 18:58:27,688 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 18:58:27,688 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 18:58:27,835 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 18:58:27,835 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 18:58:28,013 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 18:58:28,013 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 18:58:28,263 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 18:58:28,263 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 18:58:28,469 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 18:58:28,471 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 18:58:28,682 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 18:58:28,682 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 18:58:28,844 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 18:58:28,845 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 18:58:29,055 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 18:58:29,055 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 18:58:29,229 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 18:58:29,229 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 18:58:29,393 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 18:58:29,394 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 18:58:29,608 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 18:58:29,609 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 18:58:29,811 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 18:58:29,812 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 18:58:29,812 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 18:58:29,812 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 18:58:29,812 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 18:58:29,855 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 18:58:29,856 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 18:58:43,758 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 18:58:43,759 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 18:58:43,760 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 18:58:43,761 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 18:58:51,241 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 18:58:51,243 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 18:58:51,243 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 18:58:51,243 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 18:58:57,406 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 18:58:57,406 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 18:58:57,406 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 18:58:57,407 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 18:59:01,778 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 18:59:01,779 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 18:59:01,779 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 18:59:01,779 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 18:59:01,837 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 18:59:01,837 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 18:59:01,837 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 18:59:01,837 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 18:59:01,946 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 18:59:01,948 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 18:59:01,965 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 18:59:01,966 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 18:59:01,966 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 18:59:01,966 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 18:59:01,967 - heart_disease_prediction - INFO - Scaling features
2025-10-25 18:59:02,334 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 18:59:02,334 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 18:59:02,334 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 18:59:02,334 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 18:59:02,335 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 18:59:02,342 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 18:59:02,343 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 18:59:02,343 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 18:59:02,343 - heart_disease_prediction - ERROR - Error in handle_class_imbalance: 'ModelConfig' object has no attribute 'smote_random_state'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 189, in handle_class_imbalance
    self.smote = SMOTE(random_state=config.model.smote_random_state, k_neighbors=config.model.smote_k_neighbors)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'smote_random_state'
2025-10-25 18:59:02,354 - heart_disease_prediction - ERROR - Unexpected data error: 'ModelConfig' object has no attribute 'smote_random_state'
2025-10-25 18:59:02,354 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: 'ModelConfig' object has no attribute 'smote_random_state'
2025-10-25 18:59:02,355 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: 'ModelConfig' object has no attribute 'smote_random_state'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 189, in handle_class_imbalance
    self.smote = SMOTE(random_state=config.model.smote_random_state, k_neighbors=config.model.smote_k_neighbors)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'smote_random_state'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 71, in run_complete_pipeline
    X_balanced, y_balanced = self.data_service.handle_class_imbalance(X_scaled, y)
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'ModelConfig' object has no attribute 'smote_random_state'
2025-10-25 18:59:02,363 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'ModelConfig' object has no attribute 'smote_random_state'
2025-10-25 19:19:52,955 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 19:19:52,960 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 19:19:52,961 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 19:19:52,961 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 19:19:52,961 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 19:19:52,962 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 19:19:52,962 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 19:19:52,962 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 19:20:03,207 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 19:20:03,208 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 19:20:04,585 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 19:20:04,585 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 19:20:04,880 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 19:20:04,890 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 19:20:04,891 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 19:20:04,891 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 19:20:04,891 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 19:20:04,891 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 19:20:04,891 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 19:20:04,933 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 19:20:04,933 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 19:20:05,424 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 19:20:05,424 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 19:20:05,424 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:20:05,746 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 19:20:05,746 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 19:20:05,746 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 19:20:05,747 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 19:20:05,747 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 19:20:06,142 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 19:20:06,142 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 19:20:06,142 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 19:20:06,280 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 19:20:06,280 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 19:20:06,393 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 19:20:06,393 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 19:20:06,513 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 19:20:06,514 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 19:20:06,651 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 19:20:06,652 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 19:20:06,758 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 19:20:06,758 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 19:20:06,860 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 19:20:06,861 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 19:20:07,045 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 19:20:07,045 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 19:20:07,149 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 19:20:07,149 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 19:20:07,252 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 19:20:07,252 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 19:20:07,377 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 19:20:07,377 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 19:20:07,482 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 19:20:07,482 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 19:20:07,580 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 19:20:07,580 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 19:20:07,692 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 19:20:07,693 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 19:20:07,789 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 19:20:07,790 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 19:20:07,919 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 19:20:07,920 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 19:20:19,360 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 19:20:19,360 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 19:20:19,360 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 19:20:19,360 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 19:20:26,393 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 19:20:26,393 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 19:20:26,394 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 19:20:26,394 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 19:20:54,609 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 19:20:54,610 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 19:20:54,610 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 19:20:54,610 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 19:21:02,640 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 19:21:02,641 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 19:21:02,643 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 19:21:02,643 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 19:21:02,811 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 19:21:02,812 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 19:21:02,812 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 19:21:02,812 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 19:21:03,056 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 19:21:03,059 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 19:21:03,081 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 19:21:03,084 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 19:21:03,088 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 19:21:03,089 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 19:21:03,089 - heart_disease_prediction - INFO - Scaling features
2025-10-25 19:21:03,610 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 19:21:03,610 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 19:21:03,610 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 19:21:03,611 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 19:21:03,611 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 19:21:03,616 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 19:21:03,623 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 19:21:03,623 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 19:21:28,597 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 19:21:28,600 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 19:21:28,600 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 19:21:28,601 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 19:21:28,602 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 19:21:28,602 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 19:21:28,771 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 19:21:28,772 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 19:21:28,776 - heart_disease_prediction - ERROR - Error in select_features: 'ModelConfig' object has no attribute 'n_features_select'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 217, in select_features
    selector_f = SelectKBest(score_func=f_classif, k=config.model.n_features_select)
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'n_features_select'
2025-10-25 19:21:28,843 - heart_disease_prediction - ERROR - Unexpected data error: 'ModelConfig' object has no attribute 'n_features_select'
2025-10-25 19:21:28,846 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: 'ModelConfig' object has no attribute 'n_features_select'
2025-10-25 19:21:28,847 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: 'ModelConfig' object has no attribute 'n_features_select'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 217, in select_features
    selector_f = SelectKBest(score_func=f_classif, k=config.model.n_features_select)
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'n_features_select'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 74, in run_complete_pipeline
    X_selected, selected_features = self.data_service.select_features(X_balanced, y_balanced)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'ModelConfig' object has no attribute 'n_features_select'
2025-10-25 19:21:28,883 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'ModelConfig' object has no attribute 'n_features_select'
2025-10-25 19:23:11,737 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 19:23:11,740 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 19:23:11,741 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 19:23:11,741 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 19:23:11,741 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 19:23:11,741 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 19:23:11,741 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 19:23:11,742 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 19:23:20,369 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 19:23:20,370 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 19:23:21,877 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 19:23:21,877 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 19:23:22,130 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 19:23:22,138 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 19:23:22,138 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 19:23:22,138 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 19:23:22,139 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 19:23:22,139 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 19:23:22,139 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 19:23:22,176 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 19:23:22,177 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 19:23:22,695 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 19:23:22,695 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 19:23:22,696 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:23:22,970 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 19:23:22,970 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 19:23:22,970 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 19:23:22,971 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 19:23:22,971 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 19:23:23,260 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 19:23:23,260 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 19:23:23,260 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 19:23:23,371 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 19:23:23,372 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 19:23:23,496 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 19:23:23,497 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 19:23:23,631 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 19:23:23,632 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 19:23:23,739 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 19:23:23,739 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 19:23:23,850 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 19:23:23,850 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 19:23:23,959 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 19:23:23,960 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 19:23:24,083 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 19:23:24,084 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 19:23:24,199 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 19:23:24,199 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 19:23:24,313 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 19:23:24,314 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 19:23:24,424 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 19:23:24,424 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 19:23:24,536 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 19:23:24,536 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 19:23:24,645 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 19:23:24,646 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 19:23:24,755 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 19:23:24,755 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 19:23:24,844 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 19:23:24,844 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 19:23:24,975 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 19:23:24,975 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 19:23:24,976 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 19:23:24,976 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 19:23:24,976 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 19:23:24,976 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 19:23:24,976 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 19:23:35,980 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 19:23:35,982 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 19:23:35,983 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 19:23:35,983 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 19:23:41,026 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 19:23:41,027 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 19:23:41,027 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 19:23:41,027 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 19:23:45,701 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 19:23:45,701 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 19:23:45,701 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 19:23:45,701 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 19:23:48,871 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 19:23:48,872 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 19:23:48,872 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 19:23:48,872 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 19:23:48,904 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 19:23:48,905 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 19:23:48,905 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 19:23:48,905 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 19:23:48,975 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 19:23:48,976 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 19:23:48,986 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 19:23:48,986 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 19:23:48,987 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 19:23:48,987 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 19:23:48,987 - heart_disease_prediction - INFO - Scaling features
2025-10-25 19:23:49,272 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 19:23:49,272 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 19:23:49,273 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 19:23:49,273 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 19:23:49,273 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 19:23:49,277 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 19:23:49,277 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 19:23:49,277 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 19:24:00,836 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 19:24:00,837 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 19:24:00,837 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 19:24:00,837 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 19:24:00,837 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 19:24:00,837 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 19:24:01,116 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 19:24:01,117 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 19:24:01,207 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 19:24:01,208 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 19:24:01,208 - heart_disease_prediction - ERROR - Error in select_features: 'ModelConfig' object has no attribute 'random_state'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 224, in select_features
    rf_selector = RandomForestClassifier(n_estimators=10, random_state=config.model.random_state)
                                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'random_state'
2025-10-25 19:24:01,214 - heart_disease_prediction - ERROR - Unexpected data error: 'ModelConfig' object has no attribute 'random_state'
2025-10-25 19:24:01,214 - heart_disease_prediction - ERROR - Pipeline failed: Data processing failed: 'ModelConfig' object has no attribute 'random_state'
2025-10-25 19:24:01,214 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Data processing failed: 'ModelConfig' object has no attribute 'random_state'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 39, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\data_service.py", line 224, in select_features
    rf_selector = RandomForestClassifier(n_estimators=10, random_state=config.model.random_state)
                                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelConfig' object has no attribute 'random_state'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 74, in run_complete_pipeline
    X_selected, selected_features = self.data_service.select_features(X_balanced, y_balanced)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 51, in wrapper
    raise DataValidationError(f"Data processing failed: {str(e)}")
app.utils.error_handling.DataValidationError: Data processing failed: 'ModelConfig' object has no attribute 'random_state'
2025-10-25 19:24:01,220 - heart_disease_prediction - ERROR - Unexpected data error: Data processing failed: 'ModelConfig' object has no attribute 'random_state'
2025-10-25 19:27:09,840 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 19:27:09,842 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 19:27:09,842 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 19:27:09,843 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 19:27:09,843 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 19:27:09,843 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 19:27:09,843 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 19:27:09,843 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 19:27:18,364 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 19:27:18,365 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 19:27:20,101 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 19:27:20,102 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 19:27:20,392 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 19:27:20,400 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 19:27:20,400 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 19:27:20,401 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 19:27:20,401 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 19:27:20,401 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 19:27:20,401 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 19:27:20,439 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 19:27:20,440 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 19:27:21,023 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 19:27:21,024 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 19:27:21,024 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:27:21,325 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 19:27:21,325 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 19:27:21,325 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 19:27:21,325 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 19:27:21,326 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 19:27:21,640 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 19:27:21,641 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 19:27:21,641 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 19:27:21,750 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 19:27:21,751 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 19:27:21,865 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 19:27:21,866 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 19:27:22,014 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 19:27:22,014 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 19:27:22,178 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 19:27:22,178 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 19:27:22,301 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 19:27:22,301 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 19:27:22,426 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 19:27:22,426 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 19:27:22,558 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 19:27:22,558 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 19:27:22,733 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 19:27:22,734 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 19:27:22,849 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 19:27:22,849 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 19:27:22,975 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 19:27:22,976 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 19:27:23,097 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 19:27:23,098 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 19:27:23,229 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 19:27:23,230 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 19:27:23,351 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 19:27:23,352 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 19:27:23,484 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 19:27:23,484 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 19:27:23,619 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 19:27:23,619 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 19:27:23,620 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 19:27:23,620 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 19:27:23,620 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 19:27:23,620 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 19:27:23,620 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 19:27:33,825 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 19:27:33,827 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 19:27:33,827 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 19:27:33,827 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 19:27:40,065 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 19:27:40,066 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 19:27:40,066 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 19:27:40,066 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 19:27:47,707 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 19:27:47,708 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 19:27:47,708 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 19:27:47,708 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 19:27:50,860 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 19:27:50,860 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 19:27:50,861 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 19:27:50,861 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 19:27:50,915 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 19:27:50,915 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 19:27:50,915 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 19:27:50,916 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 19:27:51,006 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 19:27:51,008 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 19:27:51,021 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 19:27:51,023 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 19:27:51,024 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 19:27:51,024 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 19:27:51,024 - heart_disease_prediction - INFO - Scaling features
2025-10-25 19:27:51,343 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 19:27:51,343 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 19:27:51,344 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 19:27:51,344 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 19:27:51,344 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 19:27:51,348 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 19:27:51,348 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 19:27:51,348 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 19:28:02,185 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 19:28:02,186 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 19:28:02,186 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 19:28:02,186 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 19:28:02,186 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 19:28:02,187 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 19:28:02,276 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 19:28:02,276 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 19:28:02,346 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 19:28:02,346 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 19:28:12,819 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 19:28:12,908 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:28:12,912 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 19:28:12,912 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:28:12,912 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:28:13,763 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 19:28:13,763 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:28:13,763 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:28:13,763 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:28:14,194 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 19:28:14,194 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:28:14,209 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 19:28:14,209 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 19:28:14,210 - heart_disease_prediction - INFO - Initializing models
2025-10-25 19:28:14,210 - heart_disease_prediction - ERROR - Error in initialize_models: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\model_service.py", line 42, in initialize_models
    'Random Forest': RandomForestClassifier(n_estimators=config.model_params.rf_n_estimators, random_state=config.model.random_state, n_jobs=-1),
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
2025-10-25 19:28:14,224 - heart_disease_prediction - ERROR - Unexpected model error: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
2025-10-25 19:28:14,224 - heart_disease_prediction - ERROR - Pipeline failed: Model operation failed: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
2025-10-25 19:28:14,224 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Model operation failed: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 60, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\model_service.py", line 42, in initialize_models
    'Random Forest': RandomForestClassifier(n_estimators=config.model_params.rf_n_estimators, random_state=config.model.random_state, n_jobs=-1),
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 85, in run_complete_pipeline
    models, class_weights = self.model_service.initialize_models()
                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Heart-Disease\app\utils\error_handling.py", line 69, in wrapper
    raise ModelValidationError(f"Model operation failed: {str(e)}")
app.utils.error_handling.ModelValidationError: Model operation failed: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
2025-10-25 19:28:14,231 - heart_disease_prediction - ERROR - Unexpected data error: Model operation failed: 'ModelParamsConfig' object has no attribute 'rf_n_estimators'
2025-10-25 19:36:22,005 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 19:36:22,007 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 19:36:22,007 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 19:36:22,007 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 19:36:22,007 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 19:36:22,008 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 19:36:22,008 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 19:36:22,008 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 19:36:30,597 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 19:36:30,598 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 19:36:32,096 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 19:36:32,096 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 19:36:32,345 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 19:36:32,351 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 19:36:32,351 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 19:36:32,351 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 19:36:32,351 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 19:36:32,351 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 19:36:32,352 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 19:36:32,391 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 19:36:32,391 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 19:36:32,935 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 19:36:32,935 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 19:36:32,935 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:36:33,218 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 19:36:33,218 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 19:36:33,219 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 19:36:33,219 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 19:36:33,219 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 19:36:33,562 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 19:36:33,562 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 19:36:33,563 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 19:36:33,676 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 19:36:33,677 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 19:36:33,813 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 19:36:33,813 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 19:36:33,953 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 19:36:33,953 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 19:36:34,075 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 19:36:34,075 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 19:36:34,195 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 19:36:34,195 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 19:36:34,308 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 19:36:34,309 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 19:36:34,440 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 19:36:34,440 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 19:36:34,550 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 19:36:34,551 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 19:36:34,659 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 19:36:34,659 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 19:36:34,764 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 19:36:34,764 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 19:36:34,888 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 19:36:34,889 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 19:36:35,014 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 19:36:35,015 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 19:36:35,123 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 19:36:35,123 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 19:36:35,227 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 19:36:35,227 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 19:36:35,357 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 19:36:35,358 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 19:36:44,707 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 19:36:44,708 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 19:36:44,708 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 19:36:44,708 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 19:36:52,458 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 19:36:52,458 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 19:36:52,458 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 19:36:52,458 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 19:36:58,106 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 19:36:58,107 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 19:36:58,107 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 19:36:58,107 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 19:37:01,367 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 19:37:01,367 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 19:37:01,367 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 19:37:01,367 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 19:37:01,399 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 19:37:01,400 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 19:37:01,400 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 19:37:01,400 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 19:37:01,467 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 19:37:01,468 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 19:37:01,479 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 19:37:01,479 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 19:37:01,480 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 19:37:01,480 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 19:37:01,480 - heart_disease_prediction - INFO - Scaling features
2025-10-25 19:37:01,756 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 19:37:01,757 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 19:37:01,757 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 19:37:01,757 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 19:37:01,757 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 19:37:01,761 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 19:37:01,761 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 19:37:01,761 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 19:37:11,241 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 19:37:11,242 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 19:37:11,242 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 19:37:11,242 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 19:37:11,242 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 19:37:11,243 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 19:37:11,450 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 19:37:11,451 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 19:37:11,538 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 19:37:11,539 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 19:37:21,936 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 19:37:22,018 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:37:22,021 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 19:37:22,021 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:37:22,022 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:37:23,175 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 19:37:23,176 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:37:23,176 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:37:23,176 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:37:23,625 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 19:37:23,625 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:37:23,642 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 19:37:23,643 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 19:37:23,643 - heart_disease_prediction - INFO - Initializing models
2025-10-25 19:37:23,646 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 19:37:23,647 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 19:37:23,647 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 19:37:23,647 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 19:37:23,647 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 19:37:23,647 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 19:37:23,648 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 19:37:41,045 - heart_disease_prediction - INFO - Random Forest training completed in 17.40 seconds
2025-10-25 19:37:41,046 - model_service - INFO - Model Random Forest trained with params: {'training_time': 17.39758825302124}
2025-10-25 19:37:41,047 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 19:37:41,047 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 19:37:52,773 - heart_disease_prediction - INFO - XGBoost training completed in 11.73 seconds
2025-10-25 19:37:52,773 - model_service - INFO - Model XGBoost trained with params: {'training_time': 11.725165605545044}
2025-10-25 19:37:52,773 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 19:37:52,773 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 19:38:07,203 - heart_disease_prediction - INFO - Logistic Regression training completed in 14.43 seconds
2025-10-25 19:38:07,203 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 14.429334878921509}
2025-10-25 19:38:07,204 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 19:38:07,204 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 19:38:07,204 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 19:38:07,204 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 19:38:07,204 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 19:38:08,881 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 19:38:08,881 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 19:38:09,364 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 19:38:09,364 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 19:38:09,552 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 19:38:09,554 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 19:38:09,556 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 19:38:09,556 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 19:38:09,559 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 19:41:31,305 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695564545737225), 'std': np.float64(0.00030346537520287246)}}
2025-10-25 19:41:31,309 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 19:42:37,238 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 19:42:37,242 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 19:43:13,381 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 19:43:13,383 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 19:43:13,384 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 19:43:13,385 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 19:43:13,386 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 19:43:13,386 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 19:43:13,386 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 19:43:13,386 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 19:43:13,387 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 19:43:15,632 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 19:43:15,633 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 19:43:15,633 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 19:43:15,727 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 19:43:15,728 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 19:43:15,729 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 19:43:15,731 - heart_disease_prediction - ERROR - Error in validate_model_performance: 'Config' object has no attribute 'thresholds'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\model_service.py", line 336, in validate_model_performance
    'accuracy': config.thresholds.min_accuracy_threshold,
                ^^^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'thresholds'
2025-10-25 19:43:15,800 - heart_disease_prediction - ERROR - Unexpected model error: 'Config' object has no attribute 'thresholds'
2025-10-25 19:43:15,800 - heart_disease_prediction - ERROR - Pipeline failed: Model operation failed: 'Config' object has no attribute 'thresholds'
2025-10-25 19:43:15,800 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: Model operation failed: 'Config' object has no attribute 'thresholds'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\error_handling.py", line 60, in wrapper
    return func(*args, **kwargs)
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\services\model_service.py", line 336, in validate_model_performance
    'accuracy': config.thresholds.min_accuracy_threshold,
                ^^^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'thresholds'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 108, in run_complete_pipeline
    performance_valid = self.model_service.validate_model_performance(final_metrics)
  File "E:\Heart-Disease\app\utils\error_handling.py", line 69, in wrapper
    raise ModelValidationError(f"Model operation failed: {str(e)}")
app.utils.error_handling.ModelValidationError: Model operation failed: 'Config' object has no attribute 'thresholds'
2025-10-25 19:43:15,811 - heart_disease_prediction - ERROR - Unexpected data error: Model operation failed: 'Config' object has no attribute 'thresholds'
2025-10-25 19:50:53,057 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 19:50:53,059 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 19:51:02,782 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 19:51:02,783 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 19:51:03,974 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 19:51:03,974 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 19:51:04,411 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 19:51:04,417 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 19:51:04,418 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 19:51:04,418 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 19:51:04,418 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 19:51:04,418 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 19:51:04,419 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 19:51:04,469 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 19:51:04,469 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 19:51:05,075 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 19:51:05,075 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 19:51:05,075 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:51:05,337 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 19:51:05,338 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 19:51:05,338 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 19:51:05,338 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 19:51:05,338 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 19:51:05,534 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 19:51:05,534 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 19:51:05,534 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 19:51:05,661 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 19:51:05,662 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 19:51:05,783 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 19:51:05,784 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 19:51:05,900 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 19:51:05,900 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 19:51:06,038 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 19:51:06,039 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 19:51:06,137 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 19:51:06,137 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 19:51:06,225 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 19:51:06,226 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 19:51:06,312 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 19:51:06,313 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 19:51:06,427 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 19:51:06,427 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 19:51:06,535 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 19:51:06,536 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 19:51:06,633 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 19:51:06,633 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 19:51:06,747 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 19:51:06,747 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 19:51:06,845 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 19:51:06,846 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 19:51:06,932 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 19:51:06,933 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 19:51:07,016 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 19:51:07,017 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 19:51:07,127 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 19:51:07,127 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 19:51:07,128 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 19:51:07,128 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 19:51:07,128 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 19:51:07,128 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 19:51:07,128 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 19:51:14,902 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 19:51:14,904 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 19:51:14,904 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 19:51:14,904 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 19:51:20,518 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 19:51:20,518 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 19:51:20,518 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 19:51:20,519 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 19:51:24,621 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 19:51:24,621 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 19:51:24,622 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 19:51:24,622 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 19:51:27,758 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 19:51:27,758 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 19:51:27,758 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 19:51:27,758 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 19:51:27,781 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 19:51:27,782 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 19:51:27,782 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 19:51:27,782 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 19:51:27,824 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 19:51:27,825 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 19:51:27,834 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 19:51:27,834 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 19:51:27,834 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 19:51:27,834 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 19:51:27,835 - heart_disease_prediction - INFO - Scaling features
2025-10-25 19:51:28,000 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 19:51:28,000 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 19:51:28,000 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 19:51:28,001 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 19:51:28,001 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 19:51:28,007 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 19:51:28,008 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 19:51:28,008 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 19:51:37,771 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 19:51:37,771 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 19:51:37,771 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 19:51:37,771 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 19:51:37,771 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 19:51:37,772 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 19:51:37,909 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 19:51:37,910 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 19:51:37,962 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 19:51:37,962 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 19:51:47,010 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 19:51:47,077 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 19:51:47,079 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 19:51:47,079 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:51:47,079 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:51:47,702 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 19:51:47,702 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:51:47,702 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 19:51:47,702 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 19:51:48,032 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 19:51:48,032 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 19:51:48,044 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 19:51:48,044 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 19:51:48,044 - heart_disease_prediction - INFO - Initializing models
2025-10-25 19:51:48,047 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 19:51:48,048 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 19:52:03,399 - heart_disease_prediction - INFO - Random Forest training completed in 15.35 seconds
2025-10-25 19:52:03,399 - model_service - INFO - Model Random Forest trained with params: {'training_time': 15.350200891494751}
2025-10-25 19:52:03,399 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 19:52:03,400 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 19:52:08,143 - heart_disease_prediction - INFO - XGBoost training completed in 4.74 seconds
2025-10-25 19:52:08,143 - model_service - INFO - Model XGBoost trained with params: {'training_time': 4.743282079696655}
2025-10-25 19:52:08,144 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 19:52:08,144 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 19:52:16,516 - heart_disease_prediction - INFO - Logistic Regression training completed in 8.37 seconds
2025-10-25 19:52:16,517 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 8.372277975082397}
2025-10-25 19:52:16,517 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 19:52:16,517 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 19:52:16,517 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 19:52:16,517 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 19:52:16,517 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 19:52:17,522 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 19:52:17,522 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 19:52:18,004 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 19:52:18,005 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 19:52:18,138 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 19:52:18,139 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 19:52:18,139 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 19:52:18,139 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 19:52:18,139 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 19:54:58,954 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695566422158272), 'std': np.float64(0.0003034876960089189)}}
2025-10-25 19:54:58,955 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 19:56:00,853 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 19:56:00,854 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 19:56:34,333 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 19:56:34,333 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 19:56:34,334 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 19:56:34,335 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 19:56:34,335 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 19:56:34,336 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 19:56:34,336 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 19:56:34,336 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 19:56:34,336 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 19:56:36,711 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 19:56:36,712 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 19:56:36,713 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 19:56:36,782 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 19:56:36,782 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 19:56:36,783 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 19:56:36,785 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 19:56:36,786 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 19:56:36,786 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 19:56:36,787 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 19:56:36,787 - heart_disease_prediction - INFO - Saving models
2025-10-25 19:56:37,288 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 19:56:37,289 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 19:56:37,566 - heart_disease_prediction - ERROR - Pipeline failed: [WinError 1314] A required privilege is not held by the client: 'heart_disease_model_random forest_20251025_195637.pkl' -> './models\\heart_disease_model_latest.pkl'
2025-10-25 19:56:37,567 - heart_disease_prediction - ERROR - Error in run_complete_pipeline: [WinError 1314] A required privilege is not held by the client: 'heart_disease_model_random forest_20251025_195637.pkl' -> './models\\heart_disease_model_latest.pkl'
Traceback (most recent call last):
  File "E:\Heart-Disease\app\utils\logging_utils.py", line 35, in wrapper
    result = func(*args, **kwargs)
  File "E:\Heart-Disease\app\main.py", line 137, in run_complete_pipeline
    os.symlink(os.path.basename(model_path), latest_model_path)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: [WinError 1314] A required privilege is not held by the client: 'heart_disease_model_random forest_20251025_195637.pkl' -> './models\\heart_disease_model_latest.pkl'
2025-10-25 19:56:37,594 - heart_disease_prediction - ERROR - Unexpected data error: [WinError 1314] A required privilege is not held by the client: 'heart_disease_model_random forest_20251025_195637.pkl' -> './models\\heart_disease_model_latest.pkl'
2025-10-25 20:01:07,878 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 20:01:07,880 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 20:01:07,880 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 20:01:07,880 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 20:01:07,880 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 20:01:07,880 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 20:01:07,881 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 20:01:07,881 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 20:01:16,019 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 20:01:16,020 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 20:01:17,489 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 20:01:17,489 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 20:01:17,757 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 20:01:17,762 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 20:01:17,763 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 20:01:17,763 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 20:01:17,763 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 20:01:17,763 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 20:01:17,763 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 20:01:17,789 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 20:01:17,790 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 20:01:18,210 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 20:01:18,211 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 20:01:18,211 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 20:01:18,472 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 20:01:18,472 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 20:01:18,472 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 20:01:18,473 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 20:01:18,473 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 20:01:18,688 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 20:01:18,689 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 20:01:18,689 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 20:01:18,802 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 20:01:18,802 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 20:01:18,908 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 20:01:18,909 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 20:01:19,028 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 20:01:19,028 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 20:01:19,128 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 20:01:19,128 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 20:01:19,250 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 20:01:19,251 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 20:01:19,341 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 20:01:19,341 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 20:01:19,455 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 20:01:19,455 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 20:01:19,574 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 20:01:19,574 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 20:01:19,686 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 20:01:19,686 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 20:01:19,788 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 20:01:19,788 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 20:01:19,894 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 20:01:19,894 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 20:01:20,032 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 20:01:20,032 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 20:01:20,148 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 20:01:20,148 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 20:01:20,245 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 20:01:20,245 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 20:01:20,372 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 20:01:20,373 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 20:01:29,694 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 20:01:29,695 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 20:01:29,695 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 20:01:29,697 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 20:01:38,287 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 20:01:38,287 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 20:01:38,287 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 20:01:38,287 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 20:01:41,952 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 20:01:41,952 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 20:01:41,952 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 20:01:41,952 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 20:01:44,613 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 20:01:44,613 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 20:01:44,614 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 20:01:44,614 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 20:01:44,648 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 20:01:44,648 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 20:01:44,648 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 20:01:44,648 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 20:01:44,699 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 20:01:44,700 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 20:01:44,711 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 20:01:44,711 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 20:01:44,711 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 20:01:44,712 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 20:01:44,712 - heart_disease_prediction - INFO - Scaling features
2025-10-25 20:01:44,869 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 20:01:44,870 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 20:01:44,870 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 20:01:44,870 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 20:01:44,870 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 20:01:44,874 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 20:01:44,874 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 20:01:44,874 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 20:01:53,626 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 20:01:53,626 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 20:01:53,626 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 20:01:53,626 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 20:01:53,627 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 20:01:53,627 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 20:01:53,681 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 20:01:53,681 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 20:01:53,716 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 20:01:53,716 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 20:02:02,798 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 20:02:02,886 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 20:02:02,888 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 20:02:02,888 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 20:02:02,888 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 20:02:03,510 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 20:02:03,510 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 20:02:03,510 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 20:02:03,510 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 20:02:03,950 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 20:02:03,950 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 20:02:03,962 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 20:02:03,962 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 20:02:03,962 - heart_disease_prediction - INFO - Initializing models
2025-10-25 20:02:03,963 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 20:02:03,963 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 20:02:03,964 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 20:02:03,964 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 20:02:03,964 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 20:02:03,964 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 20:02:03,965 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 20:02:41,151 - heart_disease_prediction - INFO - Random Forest training completed in 37.18 seconds
2025-10-25 20:02:41,157 - model_service - INFO - Model Random Forest trained with params: {'training_time': 37.183884382247925}
2025-10-25 20:02:41,198 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 20:02:41,199 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 20:02:58,948 - heart_disease_prediction - INFO - XGBoost training completed in 17.75 seconds
2025-10-25 20:02:58,949 - model_service - INFO - Model XGBoost trained with params: {'training_time': 17.74891996383667}
2025-10-25 20:02:58,949 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 20:02:58,949 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 20:03:19,724 - heart_disease_prediction - INFO - Logistic Regression training completed in 20.77 seconds
2025-10-25 20:03:19,725 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 20.77430272102356}
2025-10-25 20:03:19,726 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 20:03:19,727 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 20:03:19,728 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 20:03:19,730 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 20:03:19,730 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 20:03:23,164 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 20:03:23,164 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 20:03:24,636 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 20:03:24,636 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 20:03:24,921 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 20:03:24,921 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 20:03:24,923 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 20:03:24,925 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 20:03:24,930 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 20:07:39,862 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695566193297575), 'std': np.float64(0.00030354305520225995)}}
2025-10-25 20:07:39,872 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 20:09:10,321 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 20:09:10,321 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 20:10:15,883 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 20:10:15,886 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 20:10:15,889 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 20:10:15,890 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 20:10:15,892 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 20:10:15,893 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 20:10:15,893 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 20:10:15,893 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 20:10:15,893 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 20:10:19,587 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 20:10:19,588 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 20:10:19,589 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 20:10:19,702 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 20:10:19,703 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 20:10:19,703 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 20:10:19,704 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 20:10:19,706 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 20:10:19,706 - heart_disease_prediction - INFO - Saving models
2025-10-25 20:10:24,395 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 20:10:24,395 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 20:10:29,327 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_random forest_20251025_201024.pkl
2025-10-25 20:10:29,328 - heart_disease_prediction - INFO - Symlink created at ./models\heart_disease_model_latest.pkl
2025-10-25 20:10:30,284 - heart_disease_prediction - INFO - Preprocessing artifacts saved to ./models
2025-10-25 20:10:30,301 - heart_disease_prediction - INFO - Starting plot_model_comparison
2025-10-25 20:10:30,304 - heart_disease_prediction - INFO - Creating model comparison plots
2025-10-25 20:10:45,611 - heart_disease_prediction - INFO - Model comparison plots saved
2025-10-25 20:10:45,623 - heart_disease_prediction - INFO - Completed plot_model_comparison successfully
2025-10-25 20:10:45,623 - heart_disease_prediction - INFO - Starting plot_feature_importance
2025-10-25 20:10:45,624 - heart_disease_prediction - INFO - Creating feature importance plots
2025-10-25 20:10:57,011 - heart_disease_prediction - INFO - Feature importance plots saved
2025-10-25 20:10:57,011 - heart_disease_prediction - INFO - Completed plot_feature_importance successfully
2025-10-25 20:10:57,011 - heart_disease_prediction - INFO - Final visualizations generated
2025-10-25 20:10:57,779 - heart_disease_prediction - INFO - Summary report saved to ./outputs\pipeline_summary.json
2025-10-25 20:10:57,779 - heart_disease_prediction - INFO - Complete ML pipeline finished successfully
2025-10-25 20:11:00,130 - heart_disease_prediction - INFO - Completed run_complete_pipeline successfully
2025-10-25 20:48:08,674 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 20:48:08,676 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 20:48:08,676 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 20:48:08,678 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 20:48:08,678 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 20:48:08,678 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 20:48:08,678 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 20:48:08,678 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 20:48:18,934 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 20:48:18,934 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 20:48:20,427 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 20:48:20,427 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 20:48:20,677 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 20:48:20,683 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 20:48:20,683 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 20:48:20,683 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 20:48:20,683 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 20:48:20,683 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 20:48:20,683 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 20:48:20,725 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 20:48:20,725 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 20:48:21,262 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 20:48:21,262 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 20:48:21,263 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 20:48:21,571 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 20:48:21,571 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 20:48:21,571 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 20:48:21,571 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 20:48:21,572 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 20:48:21,784 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 20:48:21,784 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 20:48:21,784 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 20:48:21,885 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 20:48:21,885 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 20:48:21,970 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 20:48:21,970 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 20:48:22,079 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 20:48:22,080 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 20:48:22,185 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 20:48:22,185 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 20:48:22,275 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 20:48:22,275 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 20:48:22,379 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 20:48:22,379 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 20:48:22,472 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 20:48:22,472 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 20:48:22,573 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 20:48:22,574 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 20:48:22,703 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 20:48:22,703 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 20:48:22,802 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 20:48:22,802 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 20:48:22,906 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 20:48:22,906 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 20:48:23,025 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 20:48:23,026 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 20:48:23,125 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 20:48:23,125 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 20:48:23,222 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 20:48:23,222 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 20:48:23,338 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 20:48:23,338 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 20:48:23,339 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 20:48:23,339 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 20:48:23,339 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 20:48:23,339 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 20:48:23,339 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 20:48:36,308 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 20:48:36,308 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 20:48:36,309 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 20:48:36,309 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 20:48:43,571 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 20:48:43,572 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 20:48:43,572 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 20:48:43,572 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 20:48:47,426 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 20:48:47,427 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 20:48:47,427 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 20:48:47,427 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 20:48:49,887 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 20:48:49,887 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 20:48:49,887 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 20:48:49,887 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 20:48:49,912 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 20:48:49,912 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 20:48:49,912 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 20:48:49,912 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 20:48:49,959 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 20:48:49,960 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 20:48:49,969 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 20:48:49,969 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 20:48:49,969 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 20:48:49,970 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 20:48:49,970 - heart_disease_prediction - INFO - Scaling features
2025-10-25 20:48:50,141 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 20:48:50,142 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 20:48:50,142 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 20:48:50,142 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 20:48:50,143 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 20:48:50,150 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 20:48:50,150 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 20:48:50,151 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 20:49:03,175 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 20:49:03,175 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 20:49:03,176 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 20:49:03,176 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 20:49:03,176 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 20:49:03,176 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 20:49:03,256 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 20:49:03,256 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 20:49:03,302 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 20:49:03,302 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 20:49:12,504 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 20:49:12,576 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 20:49:12,580 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 20:49:12,580 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 20:49:12,580 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 20:49:13,189 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 20:49:13,189 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 20:49:13,189 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 20:49:13,189 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 20:49:13,548 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 20:49:13,548 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 20:49:13,558 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 20:49:13,559 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 20:49:13,559 - heart_disease_prediction - INFO - Initializing models
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 20:49:13,562 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 20:49:27,638 - heart_disease_prediction - INFO - Random Forest training completed in 14.08 seconds
2025-10-25 20:49:27,638 - model_service - INFO - Model Random Forest trained with params: {'training_time': 14.075065851211548}
2025-10-25 20:49:27,638 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 20:49:27,639 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 20:49:32,396 - heart_disease_prediction - INFO - XGBoost training completed in 4.76 seconds
2025-10-25 20:49:32,396 - model_service - INFO - Model XGBoost trained with params: {'training_time': 4.756792306900024}
2025-10-25 20:49:32,396 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 20:49:32,396 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 20:49:44,098 - heart_disease_prediction - INFO - Logistic Regression training completed in 11.70 seconds
2025-10-25 20:49:44,098 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 11.701748609542847}
2025-10-25 20:49:44,099 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 20:49:44,099 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 20:49:44,099 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 20:49:44,099 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 20:49:44,099 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 20:49:45,708 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 20:49:45,708 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 20:49:46,278 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 20:49:46,278 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 20:49:46,451 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 20:49:46,452 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 20:49:46,453 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 20:49:46,453 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 20:49:46,455 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 20:52:18,731 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695565688150009), 'std': np.float64(0.0003034908193410441)}}
2025-10-25 20:52:18,731 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 20:53:17,147 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 20:53:17,148 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 20:54:07,838 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 20:54:07,840 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 20:54:07,840 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 20:54:07,840 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 20:54:07,842 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 20:54:07,842 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 20:54:07,842 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 20:54:07,842 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 20:54:07,842 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 20:54:10,357 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 20:54:10,360 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 20:54:10,361 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 20:54:10,450 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 20:54:10,451 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 20:54:10,452 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 20:54:10,452 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 20:54:10,452 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 20:54:10,453 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 20:54:10,453 - heart_disease_prediction - INFO - Saving models
2025-10-25 20:54:11,141 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 20:54:11,141 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 20:54:11,658 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_random forest_20251025_205411.pkl
2025-10-25 20:54:11,658 - heart_disease_prediction - INFO - Symlink created at ./models\heart_disease_model_latest.pkl
2025-10-25 20:54:11,897 - heart_disease_prediction - INFO - Preprocessing artifacts saved to ./models
2025-10-25 20:54:11,918 - heart_disease_prediction - INFO - Starting plot_model_comparison
2025-10-25 20:54:11,920 - heart_disease_prediction - INFO - Creating model comparison plots
2025-10-25 20:54:14,634 - heart_disease_prediction - INFO - Model comparison plots saved
2025-10-25 20:54:14,635 - heart_disease_prediction - INFO - Completed plot_model_comparison successfully
2025-10-25 20:54:14,635 - heart_disease_prediction - INFO - Starting plot_feature_importance
2025-10-25 20:54:14,635 - heart_disease_prediction - INFO - Creating feature importance plots
2025-10-25 20:54:16,800 - heart_disease_prediction - INFO - Feature importance plots saved
2025-10-25 20:54:16,801 - heart_disease_prediction - INFO - Completed plot_feature_importance successfully
2025-10-25 20:54:16,801 - heart_disease_prediction - INFO - Final visualizations generated
2025-10-25 20:54:16,847 - heart_disease_prediction - INFO - Summary report saved to ./outputs\pipeline_summary.json
2025-10-25 20:54:16,847 - heart_disease_prediction - INFO - Complete ML pipeline finished successfully
2025-10-25 20:54:17,088 - heart_disease_prediction - INFO - Completed run_complete_pipeline successfully
2025-10-25 21:23:09,861 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 21:23:09,862 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 21:23:09,863 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 21:23:19,814 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 21:23:19,814 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 21:23:21,629 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 21:23:21,629 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 21:23:22,029 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 21:23:22,038 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 21:23:22,038 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 21:23:22,038 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 21:23:22,038 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 21:23:22,039 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 21:23:22,039 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 21:23:22,082 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 21:23:22,082 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 21:23:22,652 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 21:23:22,653 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 21:23:22,653 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:23:22,961 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 21:23:22,961 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 21:23:22,961 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 21:23:22,961 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 21:23:22,961 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 21:23:23,184 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 21:23:23,184 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 21:23:23,184 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 21:23:23,300 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 21:23:23,301 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 21:23:23,408 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 21:23:23,408 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 21:23:23,530 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 21:23:23,531 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 21:23:23,644 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 21:23:23,644 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 21:23:23,771 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 21:23:23,771 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 21:23:23,872 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 21:23:23,872 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 21:23:23,982 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 21:23:23,982 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 21:23:24,102 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 21:23:24,102 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 21:23:24,216 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 21:23:24,216 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 21:23:24,324 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 21:23:24,324 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 21:23:24,439 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 21:23:24,439 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 21:23:24,542 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 21:23:24,542 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 21:23:24,677 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 21:23:24,677 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 21:23:24,846 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 21:23:24,846 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 21:23:24,984 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 21:23:24,985 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 21:23:39,091 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 21:23:39,092 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 21:23:39,093 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 21:23:39,093 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 21:23:47,243 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 21:23:47,244 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 21:23:47,244 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 21:23:47,244 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 21:23:52,603 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 21:23:52,604 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 21:23:52,604 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 21:23:52,604 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 21:23:55,466 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 21:23:55,467 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 21:23:55,467 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 21:23:55,467 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 21:23:55,493 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 21:23:55,493 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 21:23:55,493 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 21:23:55,494 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 21:23:55,545 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 21:23:55,547 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 21:23:55,558 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 21:23:55,559 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 21:23:55,559 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 21:23:55,559 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 21:23:55,559 - heart_disease_prediction - INFO - Scaling features
2025-10-25 21:23:55,752 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 21:23:55,753 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 21:23:55,753 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 21:23:55,753 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 21:23:55,754 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 21:23:55,765 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 21:23:55,766 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 21:23:55,767 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 21:24:10,205 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 21:24:10,205 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 21:24:10,205 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 21:24:10,206 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 21:24:10,206 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 21:24:10,207 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 21:24:10,303 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 21:24:10,303 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 21:24:10,359 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 21:24:10,359 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 21:24:24,429 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 21:24:24,493 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:24:24,496 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 21:24:24,497 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:24:24,497 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:24:25,488 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 21:24:25,488 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:24:25,488 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:24:25,489 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:24:26,332 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 21:24:26,332 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:24:26,354 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 21:24:26,355 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 21:24:26,355 - heart_disease_prediction - INFO - Initializing models
2025-10-25 21:24:26,367 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 21:24:26,372 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 21:24:26,372 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 21:24:26,372 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 21:24:26,373 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 21:24:26,373 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 21:24:26,373 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 21:24:55,349 - heart_disease_prediction - INFO - Random Forest training completed in 28.98 seconds
2025-10-25 21:24:55,351 - model_service - INFO - Model Random Forest trained with params: {'training_time': 28.975940227508545}
2025-10-25 21:24:55,352 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 21:24:55,352 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 21:25:02,869 - heart_disease_prediction - INFO - XGBoost training completed in 7.52 seconds
2025-10-25 21:25:02,869 - model_service - INFO - Model XGBoost trained with params: {'training_time': 7.515791654586792}
2025-10-25 21:25:02,869 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 21:25:02,869 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 21:25:18,134 - heart_disease_prediction - INFO - Logistic Regression training completed in 15.26 seconds
2025-10-25 21:25:18,135 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 15.26481819152832}
2025-10-25 21:25:18,135 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 21:25:18,135 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 21:25:18,135 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 21:25:18,136 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 21:25:18,136 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 21:25:20,575 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9257666561225624, 'precision': 0.9419762509096719, 'recall': 0.907427672525819, 'f1': 0.9243792619945481}
2025-10-25 21:25:20,576 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 21:25:21,304 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9171147910984961, 'precision': 0.9498921122033086, 'recall': 0.880685315641885, 'f1': 0.9139804981057077}
2025-10-25 21:25:21,305 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 21:25:21,663 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.7540715916182921, 'precision': 0.7437899917965546, 'recall': 0.7751521783735723, 'f1': 0.7591473114858416}
2025-10-25 21:25:21,664 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 21:25:21,666 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 21:25:21,668 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 21:25:21,671 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 21:30:06,773 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 21:30:06,774 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 21:30:06,775 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 21:30:15,279 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 21:30:15,280 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 21:30:17,081 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 21:30:17,081 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 21:30:17,430 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 21:30:17,438 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 21:30:17,438 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 21:30:17,439 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 21:30:17,439 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 21:30:17,439 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 21:30:17,439 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 21:30:17,486 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 21:30:17,486 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 21:30:18,089 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 21:30:18,090 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 21:30:18,090 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:30:18,465 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 21:30:18,466 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 21:30:18,466 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 21:30:18,466 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 21:30:18,466 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 21:30:18,803 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 21:30:18,803 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 21:30:18,803 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 21:30:18,936 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 21:30:18,936 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 21:30:19,080 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 21:30:19,081 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 21:30:19,201 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 21:30:19,201 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 21:30:19,378 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 21:30:19,378 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 21:30:19,508 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 21:30:19,508 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 21:30:19,651 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 21:30:19,651 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 21:30:19,777 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 21:30:19,777 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 21:30:19,926 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 21:30:19,927 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 21:30:20,063 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 21:30:20,064 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 21:30:20,210 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 21:30:20,211 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 21:30:20,342 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 21:30:20,343 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 21:30:20,472 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 21:30:20,472 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 21:30:20,605 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 21:30:20,606 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 21:30:20,737 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 21:30:20,737 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 21:30:20,911 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 21:30:20,912 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 21:30:20,912 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 21:30:20,912 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 21:30:20,912 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 21:30:20,913 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 21:30:20,913 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 21:30:32,661 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 21:30:32,663 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 21:30:32,663 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 21:30:32,664 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 21:30:43,207 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 21:30:43,208 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 21:30:43,208 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 21:30:43,208 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 21:30:49,808 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 21:30:49,809 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 21:30:49,809 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 21:30:49,809 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 21:30:53,138 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 21:30:53,138 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 21:30:53,138 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 21:30:53,138 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 21:30:53,175 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 21:30:53,176 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 21:30:53,176 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 21:30:53,176 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 21:30:53,260 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 21:30:53,261 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 21:30:53,273 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 21:30:53,273 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 21:30:53,274 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 21:30:53,274 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 21:30:53,274 - heart_disease_prediction - INFO - Scaling features
2025-10-25 21:30:53,583 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 21:30:53,583 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 21:30:53,584 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 21:30:53,584 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 21:30:53,584 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 21:30:53,591 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 21:30:53,592 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 21:30:53,592 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 21:31:03,981 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 21:31:03,981 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 21:31:03,982 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 21:31:03,982 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 21:31:03,982 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 21:31:03,982 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 21:31:04,178 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 21:31:04,179 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 21:31:04,269 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 21:31:04,269 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 21:31:15,339 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 21:31:15,428 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:31:15,432 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 21:31:15,432 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:31:15,433 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:31:16,887 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 21:31:16,887 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:31:16,887 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:31:16,888 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:31:17,579 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 21:31:17,579 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:31:17,596 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 21:31:17,596 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 21:31:17,597 - heart_disease_prediction - INFO - Initializing models
2025-10-25 21:31:17,606 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 21:31:17,606 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 21:31:17,606 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 21:31:17,607 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 21:31:17,607 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 21:31:17,607 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 21:31:17,607 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 21:31:38,221 - heart_disease_prediction - INFO - Random Forest training completed in 20.61 seconds
2025-10-25 21:31:38,222 - model_service - INFO - Model Random Forest trained with params: {'training_time': 20.613508939743042}
2025-10-25 21:31:38,222 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 21:31:38,222 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 21:31:44,982 - heart_disease_prediction - INFO - XGBoost training completed in 6.76 seconds
2025-10-25 21:31:44,983 - model_service - INFO - Model XGBoost trained with params: {'training_time': 6.759773015975952}
2025-10-25 21:31:44,983 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 21:31:44,983 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 21:31:57,000 - heart_disease_prediction - INFO - Logistic Regression training completed in 12.02 seconds
2025-10-25 21:31:57,000 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 12.01662826538086}
2025-10-25 21:31:57,001 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 21:31:57,002 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 21:31:57,002 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 21:31:57,002 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 21:31:57,002 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 21:31:58,935 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 21:31:58,936 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 21:31:59,479 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 21:31:59,479 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 21:31:59,766 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 21:31:59,766 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 21:31:59,767 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 21:31:59,767 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 21:31:59,769 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 21:35:28,345 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695565370758105), 'std': np.float64(0.0003035370463782246)}}
2025-10-25 21:35:28,345 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 21:36:33,888 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 21:36:33,889 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 21:37:25,189 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 21:37:25,190 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 21:37:25,190 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 21:37:25,190 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 21:37:25,192 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 21:37:25,193 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 21:37:25,193 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 21:37:25,193 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 21:37:25,193 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 21:37:29,132 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 21:37:29,136 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 21:37:29,137 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 21:37:29,250 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 21:37:29,251 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 21:37:29,251 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 21:37:29,251 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 21:37:29,251 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 21:37:29,251 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 21:37:29,252 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 21:37:29,252 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 21:37:29,252 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 21:37:29,252 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 21:37:29,252 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 21:37:29,254 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 21:37:29,254 - heart_disease_prediction - INFO - Saving models
2025-10-25 21:37:30,027 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 21:37:30,027 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 21:37:30,825 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_random forest_20251025_213730.pkl
2025-10-25 21:37:30,826 - heart_disease_prediction - INFO - Symlink created at ./models\heart_disease_model_latest.pkl
2025-10-25 21:37:30,994 - heart_disease_prediction - INFO - Preprocessing artifacts saved to ./models
2025-10-25 21:37:31,008 - heart_disease_prediction - INFO - Starting plot_model_comparison
2025-10-25 21:37:31,009 - heart_disease_prediction - INFO - Creating model comparison plots
2025-10-25 21:37:34,076 - heart_disease_prediction - INFO - Model comparison plots saved
2025-10-25 21:37:34,077 - heart_disease_prediction - INFO - Completed plot_model_comparison successfully
2025-10-25 21:37:34,077 - heart_disease_prediction - INFO - Starting plot_feature_importance
2025-10-25 21:37:34,077 - heart_disease_prediction - INFO - Creating feature importance plots
2025-10-25 21:37:36,814 - heart_disease_prediction - INFO - Feature importance plots saved
2025-10-25 21:37:36,815 - heart_disease_prediction - INFO - Completed plot_feature_importance successfully
2025-10-25 21:37:36,815 - heart_disease_prediction - INFO - Final visualizations generated
2025-10-25 21:37:36,865 - heart_disease_prediction - INFO - Summary report saved to ./outputs\pipeline_summary.json
2025-10-25 21:37:36,865 - heart_disease_prediction - INFO - Complete ML pipeline finished successfully
2025-10-25 21:37:37,181 - heart_disease_prediction - INFO - Completed run_complete_pipeline successfully
2025-10-25 21:43:07,890 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 21:43:07,892 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 21:43:07,893 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 21:43:17,930 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 21:43:17,930 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 21:43:19,322 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 21:43:19,322 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 21:43:19,594 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 21:43:19,601 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 21:43:19,601 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 21:43:19,601 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 21:43:19,601 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 21:43:19,602 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 21:43:19,602 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 21:43:19,644 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 21:43:19,645 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 21:43:20,185 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 21:43:20,185 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 21:43:20,185 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:43:20,488 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 21:43:20,489 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 21:43:20,489 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 21:43:20,489 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 21:43:20,489 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 21:43:20,841 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 21:43:20,842 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 21:43:20,842 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 21:43:21,019 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 21:43:21,019 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 21:43:21,167 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 21:43:21,167 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 21:43:21,294 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 21:43:21,294 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 21:43:21,419 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 21:43:21,419 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 21:43:21,543 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 21:43:21,544 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 21:43:21,699 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 21:43:21,699 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 21:43:21,809 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 21:43:21,810 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 21:43:21,918 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 21:43:21,918 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 21:43:22,045 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 21:43:22,046 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 21:43:22,170 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 21:43:22,171 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 21:43:22,282 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 21:43:22,283 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 21:43:22,391 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 21:43:22,392 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 21:43:22,512 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 21:43:22,513 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 21:43:22,653 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 21:43:22,653 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 21:43:22,788 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 21:43:22,789 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 21:43:37,262 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 21:43:37,270 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 21:43:37,271 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 21:43:37,271 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 21:43:49,741 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 21:43:49,742 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 21:43:49,742 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 21:43:49,742 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 21:43:58,042 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 21:43:58,043 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 21:43:58,043 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 21:43:58,043 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 21:44:02,218 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 21:44:02,218 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 21:44:02,218 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 21:44:02,219 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 21:44:02,259 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 21:44:02,260 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 21:44:02,260 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 21:44:02,260 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 21:44:02,331 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 21:44:02,333 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 21:44:02,343 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 21:44:02,344 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 21:44:02,344 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 21:44:02,345 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 21:44:02,345 - heart_disease_prediction - INFO - Scaling features
2025-10-25 21:44:02,735 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 21:44:02,736 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 21:44:02,736 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 21:44:02,736 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 21:44:02,737 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 21:44:02,745 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 21:44:02,745 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 21:44:02,746 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 21:44:14,619 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 21:44:14,619 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 21:44:14,620 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 21:44:14,620 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 21:44:14,621 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 21:44:14,621 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 21:44:14,844 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 21:44:14,845 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 21:44:14,935 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 21:44:14,936 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 21:44:26,160 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 21:44:26,252 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 21:44:26,256 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 21:44:26,257 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:44:26,257 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:44:27,190 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 21:44:27,190 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:44:27,190 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 21:44:27,190 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 21:44:27,660 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 21:44:27,661 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 21:44:27,677 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 21:44:27,678 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 21:44:27,678 - heart_disease_prediction - INFO - Initializing models
2025-10-25 21:44:27,684 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 21:44:27,685 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 21:44:27,685 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 21:44:27,685 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 21:44:27,685 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 21:44:27,686 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 21:44:27,686 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 21:44:47,362 - heart_disease_prediction - INFO - Random Forest training completed in 19.68 seconds
2025-10-25 21:44:47,362 - model_service - INFO - Model Random Forest trained with params: {'training_time': 19.67559289932251}
2025-10-25 21:44:47,363 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 21:44:47,364 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 21:44:53,407 - heart_disease_prediction - INFO - XGBoost training completed in 6.04 seconds
2025-10-25 21:44:53,407 - model_service - INFO - Model XGBoost trained with params: {'training_time': 6.042636394500732}
2025-10-25 21:44:53,407 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 21:44:53,407 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 21:45:05,942 - heart_disease_prediction - INFO - Logistic Regression training completed in 12.53 seconds
2025-10-25 21:45:05,942 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 12.534621238708496}
2025-10-25 21:45:05,943 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 21:45:05,943 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 21:45:05,943 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 21:45:05,943 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 21:45:05,944 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 21:45:07,950 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 21:45:07,950 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 21:45:08,506 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 21:45:08,506 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 21:45:08,778 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 21:45:08,779 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 21:45:08,779 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 21:45:08,780 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 21:45:08,781 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 21:48:54,500 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695565767909637), 'std': np.float64(0.0003034692718636875)}}
2025-10-25 21:48:54,502 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 21:50:08,239 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 21:50:08,240 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 21:51:11,605 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 21:51:11,608 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 21:51:11,611 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 21:51:11,612 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 21:51:11,614 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 21:51:11,615 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 21:51:11,615 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 21:51:11,615 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 21:51:11,616 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 21:51:16,366 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 21:51:16,371 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 21:51:16,372 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 21:51:16,502 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 21:51:16,503 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 21:51:16,503 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 21:51:16,504 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 21:51:16,504 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 21:51:16,504 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 21:51:16,504 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 21:51:16,504 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 21:51:16,505 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 21:51:16,505 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 21:51:16,505 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 21:51:16,506 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 21:51:16,507 - heart_disease_prediction - INFO - Saving models
2025-10-25 21:51:17,730 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 21:51:17,730 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 21:51:18,807 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_random forest_20251025_215117.pkl
2025-10-25 21:51:18,807 - heart_disease_prediction - INFO - Symlink created at ./models\heart_disease_model_latest.pkl
2025-10-25 21:51:19,131 - heart_disease_prediction - INFO - Preprocessing artifacts saved to ./models
2025-10-25 21:51:19,171 - heart_disease_prediction - INFO - Starting plot_model_comparison
2025-10-25 21:51:19,182 - heart_disease_prediction - INFO - Creating model comparison plots
2025-10-25 21:51:23,966 - heart_disease_prediction - INFO - Model comparison plots saved
2025-10-25 21:51:23,967 - heart_disease_prediction - INFO - Completed plot_model_comparison successfully
2025-10-25 21:51:23,967 - heart_disease_prediction - INFO - Starting plot_feature_importance
2025-10-25 21:51:23,968 - heart_disease_prediction - INFO - Creating feature importance plots
2025-10-25 21:51:27,540 - heart_disease_prediction - INFO - Feature importance plots saved
2025-10-25 21:51:27,541 - heart_disease_prediction - INFO - Completed plot_feature_importance successfully
2025-10-25 21:51:27,541 - heart_disease_prediction - INFO - Final visualizations generated
2025-10-25 21:51:27,599 - heart_disease_prediction - INFO - Summary report saved to ./outputs\pipeline_summary.json
2025-10-25 21:51:27,599 - heart_disease_prediction - INFO - Complete ML pipeline finished successfully
2025-10-25 21:51:27,933 - heart_disease_prediction - INFO - Completed run_complete_pipeline successfully
2025-10-25 22:04:56,125 - heart_disease_prediction - INFO - Plotting configuration initialized
2025-10-25 22:04:56,127 - heart_disease_prediction - INFO - Application initialized successfully
2025-10-25 22:04:56,128 - heart_disease_prediction - INFO - Starting run_complete_pipeline
2025-10-25 22:04:56,128 - heart_disease_prediction - INFO - Starting complete ML pipeline
2025-10-25 22:04:56,128 - heart_disease_prediction - INFO - === STEP 1-8: DATA PROCESSING ===
2025-10-25 22:04:56,128 - heart_disease_prediction - INFO - Starting load_data
2025-10-25 22:04:56,129 - heart_disease_prediction - INFO - Starting data download from: https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv
2025-10-25 22:04:56,129 - heart_disease_prediction - INFO - This may take a few moments for large datasets...
2025-10-25 22:05:06,311 - heart_disease_prediction - INFO - Data download completed. Shape: (319795, 18)
2025-10-25 22:05:06,312 - heart_disease_prediction - INFO - Columns: ['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease', 'SkinCancer']
2025-10-25 22:05:08,288 - heart_disease_prediction - INFO - Memory usage: 232.85 MB
2025-10-25 22:05:08,288 - heart_disease_prediction - INFO - Validating downloaded data...
2025-10-25 22:05:08,639 - heart_disease_prediction - INFO - DataFrame shape: (319795, 18)
2025-10-25 22:05:08,648 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('O'): 14, dtype('float64'): 4}
2025-10-25 22:05:08,649 - data_service - INFO - Data loaded from https://github.com/shreyasdeodhare/Datasets101/raw/main/heart_2020_cleaned.csv, shape: (319795, 18)
2025-10-25 22:05:08,649 - heart_disease_prediction - INFO - Data loading and validation completed successfully
2025-10-25 22:05:08,649 - heart_disease_prediction - INFO - Completed load_data successfully
2025-10-25 22:05:08,649 - heart_disease_prediction - INFO - Starting preprocess_data
2025-10-25 22:05:08,650 - heart_disease_prediction - INFO - Starting data preprocessing
2025-10-25 22:05:08,703 - heart_disease_prediction - INFO - Starting feature engineering...
2025-10-25 22:05:08,703 - heart_disease_prediction - INFO - Input data shape: (319795, 18)
2025-10-25 22:05:09,381 - heart_disease_prediction - INFO - Feature engineering completed. New shape: (319795, 22)
2025-10-25 22:05:09,382 - heart_disease_prediction - INFO - New features created: BMI_Category, Age_Numeric, Health_Score, Risk_Score
2025-10-25 22:05:09,382 - data_service - INFO - Features engineered: ['BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 22:05:09,745 - heart_disease_prediction - INFO - Preprocessing completed. Shape: (319795, 22)
2025-10-25 22:05:09,745 - heart_disease_prediction - INFO - Completed preprocess_data successfully
2025-10-25 22:05:09,745 - heart_disease_prediction - INFO - Starting encode_categorical_variables
2025-10-25 22:05:09,745 - heart_disease_prediction - INFO - Starting categorical variable encoding...
2025-10-25 22:05:09,745 - heart_disease_prediction - INFO - Input shape: (319795, 22)
2025-10-25 22:05:10,091 - heart_disease_prediction - INFO - Found 15 categorical columns: ['HeartDisease', 'Smoking', 'AlcoholDrinking', 'Stroke', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'PhysicalActivity', 'GenHealth', 'Asthma', 'KidneyDisease', 'SkinCancer', 'BMI_Category']
2025-10-25 22:05:10,092 - heart_disease_prediction - INFO - Applying label encoding to categorical features...
2025-10-25 22:05:10,092 - heart_disease_prediction - INFO - Encoding column 2/15: Smoking
2025-10-25 22:05:10,241 - heart_disease_prediction - INFO - Encoded Smoking with 2 classes: ['No' 'Yes']
2025-10-25 22:05:10,241 - heart_disease_prediction - INFO - Encoding column 3/15: AlcoholDrinking
2025-10-25 22:05:10,381 - heart_disease_prediction - INFO - Encoded AlcoholDrinking with 2 classes: ['No' 'Yes']
2025-10-25 22:05:10,381 - heart_disease_prediction - INFO - Encoding column 4/15: Stroke
2025-10-25 22:05:10,508 - heart_disease_prediction - INFO - Encoded Stroke with 2 classes: ['No' 'Yes']
2025-10-25 22:05:10,509 - heart_disease_prediction - INFO - Encoding column 5/15: DiffWalking
2025-10-25 22:05:10,635 - heart_disease_prediction - INFO - Encoded DiffWalking with 2 classes: ['No' 'Yes']
2025-10-25 22:05:10,635 - heart_disease_prediction - INFO - Encoding column 6/15: Sex
2025-10-25 22:05:10,770 - heart_disease_prediction - INFO - Encoded Sex with 2 classes: ['Female' 'Male']
2025-10-25 22:05:10,770 - heart_disease_prediction - INFO - Encoding column 7/15: AgeCategory
2025-10-25 22:05:10,941 - heart_disease_prediction - INFO - Encoded AgeCategory with 13 classes: ['18-24' '25-29' '30-34' '35-39' '40-44' '45-49' '50-54' '55-59' '60-64'
 '65-69' '70-74' '75-79' '80 or older']
2025-10-25 22:05:10,941 - heart_disease_prediction - INFO - Encoding column 8/15: Race
2025-10-25 22:05:11,086 - heart_disease_prediction - INFO - Encoded Race with 6 classes: ['American Indian/Alaskan Native' 'Asian' 'Black' 'Hispanic' 'Other'
 'White']
2025-10-25 22:05:11,087 - heart_disease_prediction - INFO - Encoding column 9/15: Diabetic
2025-10-25 22:05:11,236 - heart_disease_prediction - INFO - Encoded Diabetic with 4 classes: ['No' 'No, borderline diabetes' 'Yes' 'Yes (during pregnancy)']
2025-10-25 22:05:11,236 - heart_disease_prediction - INFO - Encoding column 10/15: PhysicalActivity
2025-10-25 22:05:11,354 - heart_disease_prediction - INFO - Encoded PhysicalActivity with 2 classes: ['No' 'Yes']
2025-10-25 22:05:11,355 - heart_disease_prediction - INFO - Encoding column 11/15: GenHealth
2025-10-25 22:05:11,495 - heart_disease_prediction - INFO - Encoded GenHealth with 5 classes: ['Excellent' 'Fair' 'Good' 'Poor' 'Very good']
2025-10-25 22:05:11,495 - heart_disease_prediction - INFO - Encoding column 12/15: Asthma
2025-10-25 22:05:11,632 - heart_disease_prediction - INFO - Encoded Asthma with 2 classes: ['No' 'Yes']
2025-10-25 22:05:11,632 - heart_disease_prediction - INFO - Encoding column 13/15: KidneyDisease
2025-10-25 22:05:11,773 - heart_disease_prediction - INFO - Encoded KidneyDisease with 2 classes: ['No' 'Yes']
2025-10-25 22:05:11,774 - heart_disease_prediction - INFO - Encoding column 14/15: SkinCancer
2025-10-25 22:05:11,913 - heart_disease_prediction - INFO - Encoded SkinCancer with 2 classes: ['No' 'Yes']
2025-10-25 22:05:11,913 - heart_disease_prediction - INFO - Encoding column 15/15: BMI_Category
2025-10-25 22:05:12,072 - heart_disease_prediction - INFO - Encoded BMI_Category with 4 classes: ['Normal' 'Obese' 'Overweight' 'Underweight']
2025-10-25 22:05:12,072 - heart_disease_prediction - INFO - Encoding target variable: HeartDisease
2025-10-25 22:05:12,211 - heart_disease_prediction - INFO - Target variable encoded with classes: ['No' 'Yes']
2025-10-25 22:05:12,212 - heart_disease_prediction - INFO - Categorical encoding completed. Final shape: (319795, 22)
2025-10-25 22:05:12,212 - heart_disease_prediction - INFO - Completed encode_categorical_variables successfully
2025-10-25 22:05:12,212 - heart_disease_prediction - INFO - Starting generate_comprehensive_report
2025-10-25 22:05:12,212 - heart_disease_prediction - INFO - Generating comprehensive EDA report
2025-10-25 22:05:12,212 - heart_disease_prediction - INFO - Starting plot_target_distribution
2025-10-25 22:05:12,213 - heart_disease_prediction - INFO - Creating target distribution plots
2025-10-25 22:05:30,063 - heart_disease_prediction - INFO - Target distribution plots saved
2025-10-25 22:05:30,066 - heart_disease_prediction - INFO - Completed plot_target_distribution successfully
2025-10-25 22:05:30,066 - heart_disease_prediction - INFO - Starting plot_correlation_analysis
2025-10-25 22:05:30,067 - heart_disease_prediction - INFO - Creating correlation analysis plots
2025-10-25 22:05:43,149 - heart_disease_prediction - INFO - Correlation analysis plots saved
2025-10-25 22:05:43,150 - heart_disease_prediction - INFO - Completed plot_correlation_analysis successfully
2025-10-25 22:05:43,150 - heart_disease_prediction - INFO - Starting plot_feature_analysis
2025-10-25 22:05:43,150 - heart_disease_prediction - INFO - Creating feature analysis plots
2025-10-25 22:05:48,924 - heart_disease_prediction - INFO - Feature analysis plots saved
2025-10-25 22:05:48,924 - heart_disease_prediction - INFO - Completed plot_feature_analysis successfully
2025-10-25 22:05:48,924 - heart_disease_prediction - INFO - Starting plot_risk_factor_analysis
2025-10-25 22:05:48,925 - heart_disease_prediction - INFO - Creating risk factor analysis plots
2025-10-25 22:05:52,794 - heart_disease_prediction - INFO - Risk factor analysis plots saved
2025-10-25 22:05:52,795 - heart_disease_prediction - INFO - Completed plot_risk_factor_analysis successfully
2025-10-25 22:05:52,795 - heart_disease_prediction - INFO - Starting generate_data_overview
2025-10-25 22:05:52,795 - heart_disease_prediction - INFO - Generating data overview
2025-10-25 22:05:52,835 - heart_disease_prediction - INFO - Data overview saved to ./outputs\data_overview.txt
2025-10-25 22:05:52,835 - heart_disease_prediction - INFO - Completed generate_data_overview successfully
2025-10-25 22:05:52,835 - heart_disease_prediction - INFO - Comprehensive EDA report generated successfully
2025-10-25 22:05:52,835 - heart_disease_prediction - INFO - Completed generate_comprehensive_report successfully
2025-10-25 22:05:52,908 - heart_disease_prediction - INFO - DataFrame shape: (319795, 21)
2025-10-25 22:05:52,910 - heart_disease_prediction - INFO - DataFrame dtypes: {dtype('int64'): 16, dtype('float64'): 5}
2025-10-25 22:05:52,922 - heart_disease_prediction - WARNING - High class imbalance ratio: 10.68
2025-10-25 22:05:52,923 - heart_disease_prediction - INFO - Target variable classes: [0 1]
2025-10-25 22:05:52,923 - heart_disease_prediction - INFO - Class distribution: {0: 292422, 1: 27373}
2025-10-25 22:05:52,923 - heart_disease_prediction - INFO - Starting scale_features
2025-10-25 22:05:52,924 - heart_disease_prediction - INFO - Scaling features
2025-10-25 22:05:53,229 - heart_disease_prediction - INFO - Features scaled. Shape: (319795, 21)
2025-10-25 22:05:53,230 - heart_disease_prediction - INFO - Completed scale_features successfully
2025-10-25 22:05:53,230 - heart_disease_prediction - INFO - Starting handle_class_imbalance
2025-10-25 22:05:53,231 - heart_disease_prediction - INFO - Starting class imbalance handling...
2025-10-25 22:05:53,231 - heart_disease_prediction - INFO - Input data shape: (319795, 21)
2025-10-25 22:05:53,235 - heart_disease_prediction - INFO - Original class distribution: {0: 292422, 1: 27373}
2025-10-25 22:05:53,236 - data_service - INFO - Class balance: {0: 292422, 1: 27373}
2025-10-25 22:05:53,236 - heart_disease_prediction - INFO - Applying SMOTE for class balancing...
2025-10-25 22:06:04,556 - heart_disease_prediction - INFO - SMOTE completed. New shape: (584844, 21)
2025-10-25 22:06:04,557 - heart_disease_prediction - INFO - New class distribution: {0: 292422, 1: 292422}
2025-10-25 22:06:04,557 - heart_disease_prediction - INFO - Completed handle_class_imbalance successfully
2025-10-25 22:06:04,557 - heart_disease_prediction - INFO - Starting select_features
2025-10-25 22:06:04,558 - heart_disease_prediction - INFO - Starting feature selection on 584844 samples...
2025-10-25 22:06:04,558 - heart_disease_prediction - INFO - Large dataset detected. Using sample for feature selection...
2025-10-25 22:06:04,717 - heart_disease_prediction - INFO - Using sample of 50000 for feature selection
2025-10-25 22:06:04,718 - heart_disease_prediction - INFO - Running statistical feature selection...
2025-10-25 22:06:04,784 - heart_disease_prediction - INFO - Statistical selection completed: 15 features
2025-10-25 22:06:04,785 - heart_disease_prediction - INFO - Running RFE feature selection...
2025-10-25 22:06:15,100 - heart_disease_prediction - INFO - RFE selection completed: 15 features
2025-10-25 22:06:15,194 - heart_disease_prediction - INFO - Feature selection completed. Selected 15 features: ['BMI', 'Smoking', 'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory', 'Race', 'Diabetic', 'GenHealth', 'SleepTime', 'BMI_Category', 'Age_Numeric', 'Health_Score', 'Risk_Score']
2025-10-25 22:06:15,198 - heart_disease_prediction - INFO - Completed select_features successfully
2025-10-25 22:06:15,198 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 22:06:15,198 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 22:06:16,318 - heart_disease_prediction - INFO - Train set: (467875, 15), Test set: (116969, 15)
2025-10-25 22:06:16,319 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 22:06:16,319 - heart_disease_prediction - INFO - Starting split_data
2025-10-25 22:06:16,319 - heart_disease_prediction - INFO - Splitting data into train and test sets
2025-10-25 22:06:16,785 - heart_disease_prediction - INFO - Train set: (255836, 21), Test set: (63959, 21)
2025-10-25 22:06:16,786 - heart_disease_prediction - INFO - Completed split_data successfully
2025-10-25 22:06:16,802 - heart_disease_prediction - INFO - === STEP 9-16: MODEL TRAINING & EVALUATION ===
2025-10-25 22:06:16,802 - heart_disease_prediction - INFO - Starting initialize_models
2025-10-25 22:06:16,803 - heart_disease_prediction - INFO - Initializing models
2025-10-25 22:06:16,813 - heart_disease_prediction - INFO - Initialized 3 models
2025-10-25 22:06:16,813 - heart_disease_prediction - INFO - Completed initialize_models successfully
2025-10-25 22:06:16,813 - heart_disease_prediction - INFO - Starting train_models
2025-10-25 22:06:16,813 - heart_disease_prediction - INFO - Starting model training with 3 models...
2025-10-25 22:06:16,813 - heart_disease_prediction - INFO - Training data shape: (467875, 15)
2025-10-25 22:06:16,814 - heart_disease_prediction - INFO - Training model 1/3: Random Forest
2025-10-25 22:06:16,814 - heart_disease_prediction - INFO - Model type: RandomForestClassifier
2025-10-25 22:06:42,013 - heart_disease_prediction - INFO - Random Forest training completed in 25.20 seconds
2025-10-25 22:06:42,014 - model_service - INFO - Model Random Forest trained with params: {'training_time': 25.199500560760498}
2025-10-25 22:06:42,014 - heart_disease_prediction - INFO - Training model 2/3: XGBoost
2025-10-25 22:06:42,014 - heart_disease_prediction - INFO - Model type: XGBClassifier
2025-10-25 22:06:49,606 - heart_disease_prediction - INFO - XGBoost training completed in 7.59 seconds
2025-10-25 22:06:49,606 - model_service - INFO - Model XGBoost trained with params: {'training_time': 7.591293096542358}
2025-10-25 22:06:49,607 - heart_disease_prediction - INFO - Training model 3/3: Logistic Regression
2025-10-25 22:06:49,607 - heart_disease_prediction - INFO - Model type: LogisticRegression
2025-10-25 22:07:01,155 - heart_disease_prediction - INFO - Logistic Regression training completed in 11.55 seconds
2025-10-25 22:07:01,156 - model_service - INFO - Model Logistic Regression trained with params: {'training_time': 11.548312425613403}
2025-10-25 22:07:01,156 - heart_disease_prediction - INFO - All 3 models trained successfully
2025-10-25 22:07:01,157 - heart_disease_prediction - INFO - Completed train_models successfully
2025-10-25 22:07:01,157 - heart_disease_prediction - INFO - Starting evaluate_models
2025-10-25 22:07:01,158 - heart_disease_prediction - INFO - Evaluating models
2025-10-25 22:07:01,158 - heart_disease_prediction - INFO - Evaluating Random Forest...
2025-10-25 22:07:03,196 - model_service - INFO - Model Random Forest evaluation: {'accuracy': 0.9265617385803075, 'precision': 0.944007403979639, 'recall': 0.9069147117160249, 'f1': 0.9250893869364263}
2025-10-25 22:07:03,197 - heart_disease_prediction - INFO - Evaluating XGBoost...
2025-10-25 22:07:03,745 - model_service - INFO - Model XGBoost evaluation: {'accuracy': 0.9179611691986765, 'precision': 0.9518466486746275, 'recall': 0.8804630326243075, 'f1': 0.9147643495407791}
2025-10-25 22:07:03,746 - heart_disease_prediction - INFO - Evaluating Logistic Regression...
2025-10-25 22:07:04,046 - model_service - INFO - Model Logistic Regression evaluation: {'accuracy': 0.751583752960186, 'precision': 0.738999074119195, 'recall': 0.7779050680528008, 'f1': 0.7579531350221164}
2025-10-25 22:07:04,047 - heart_disease_prediction - INFO - Completed evaluate_models successfully
2025-10-25 22:07:04,047 - heart_disease_prediction - INFO - Starting cross_validation_evaluation
2025-10-25 22:07:04,049 - heart_disease_prediction - INFO - Performing cross-validation evaluation
2025-10-25 22:07:04,053 - heart_disease_prediction - INFO - Cross-validation for Random Forest...
2025-10-25 22:10:52,322 - model_service - INFO - Model Random Forest CV results: {'accuracy': {'mean': np.float64(0.9210964459506118), 'std': np.float64(0.00030534458637612)}, 'precision': {'mean': np.float64(0.936016847303287), 'std': np.float64(0.0005162861044815179)}, 'recall': {'mean': np.float64(0.9039873812136349), 'std': np.float64(0.0006126133310993929)}, 'f1': {'mean': np.float64(0.9197230992161366), 'std': np.float64(0.0003183408141085237)}, 'roc_auc': {'mean': np.float64(0.9695566078725874), 'std': np.float64(0.00030349189651096006)}}
2025-10-25 22:10:52,337 - heart_disease_prediction - INFO - Cross-validation for XGBoost...
2025-10-25 22:12:00,680 - model_service - INFO - Model XGBoost CV results: {'accuracy': {'mean': np.float64(0.9198738969919216), 'std': np.float64(0.0003315625457738577)}, 'precision': {'mean': np.float64(0.9527692282584007), 'std': np.float64(0.0010908706994376316)}, 'recall': {'mean': np.float64(0.8835503347928215), 'std': np.float64(0.0014507995170413572)}, 'f1': {'mean': np.float64(0.9168535229065972), 'std': np.float64(0.0004094652893643144)}, 'roc_auc': {'mean': np.float64(0.9750709488613046), 'std': np.float64(0.00011498921797735042)}}
2025-10-25 22:12:00,680 - heart_disease_prediction - INFO - Cross-validation for Logistic Regression...
2025-10-25 22:13:00,824 - model_service - INFO - Model Logistic Regression CV results: {'accuracy': {'mean': np.float64(0.750937750666262), 'std': np.float64(0.0005640285507899823)}, 'precision': {'mean': np.float64(0.7383377954494921), 'std': np.float64(0.0010145865837299553)}, 'recall': {'mean': np.float64(0.7773769098497804), 'std': np.float64(0.0005484914799099931)}, 'f1': {'mean': np.float64(0.7573538130395226), 'std': np.float64(0.00031081821124338555)}, 'roc_auc': {'mean': np.float64(0.8256290895322514), 'std': np.float64(0.0007100066205472819)}}
2025-10-25 22:13:00,826 - heart_disease_prediction - INFO - Completed cross_validation_evaluation successfully
2025-10-25 22:13:00,828 - heart_disease_prediction - INFO - Starting select_best_model
2025-10-25 22:13:00,828 - heart_disease_prediction - INFO - Selecting best model
2025-10-25 22:13:00,831 - heart_disease_prediction - INFO - Best model selected: Random Forest
2025-10-25 22:13:00,832 - heart_disease_prediction - INFO - Best CV F1: 0.920
2025-10-25 22:13:00,832 - heart_disease_prediction - INFO - Completed select_best_model successfully
2025-10-25 22:13:00,832 - heart_disease_prediction - INFO - Starting final_evaluation
2025-10-25 22:13:00,833 - heart_disease_prediction - INFO - Performing final evaluation
2025-10-25 22:13:05,036 - heart_disease_prediction - INFO - Final evaluation completed
2025-10-25 22:13:05,040 - heart_disease_prediction - INFO - Completed final_evaluation successfully
2025-10-25 22:13:05,041 - heart_disease_prediction - INFO - Starting get_feature_importance
2025-10-25 22:13:05,180 - heart_disease_prediction - INFO - Completed get_feature_importance successfully
2025-10-25 22:13:05,181 - heart_disease_prediction - INFO - Starting validate_model_performance
2025-10-25 22:13:05,181 - heart_disease_prediction - INFO - Validating model performance
2025-10-25 22:13:05,183 - heart_disease_prediction - INFO - Balanced Test Set accuracy meets threshold: 0.927 >= 0.7
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Balanced Test Set f1 meets threshold: 0.925 >= 0.6
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Balanced Test Set auc meets threshold: 0.972 >= 0.7
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Original Test Set accuracy meets threshold: 0.936 >= 0.7
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Original Test Set f1 meets threshold: 0.677 >= 0.6
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Original Test Set auc meets threshold: 0.941 >= 0.7
2025-10-25 22:13:05,184 - heart_disease_prediction - INFO - Completed validate_model_performance successfully
2025-10-25 22:13:05,185 - heart_disease_prediction - INFO - === STEP 17: SAVING MODELS ===
2025-10-25 22:13:05,187 - heart_disease_prediction - INFO - Starting save_models
2025-10-25 22:13:05,188 - heart_disease_prediction - INFO - Saving models
2025-10-25 22:13:05,201 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_randomforestclassifier_20251025_221305.pkl
2025-10-25 22:13:05,208 - heart_disease_prediction - WARNING - Could not create symlink: [WinError 1314] A required privilege is not held by the client: 'heart_disease_model_randomforestclassifier_20251025_221305.pkl' -> './models\\heart_disease_model_latest.pkl'
2025-10-25 22:13:07,233 - heart_disease_prediction - INFO - Models saved to ./models
2025-10-25 22:13:07,233 - heart_disease_prediction - INFO - Completed save_models successfully
2025-10-25 22:13:07,973 - heart_disease_prediction - INFO - Best model saved to ./models\heart_disease_model_random forest_20251025_221307.pkl
2025-10-25 22:13:07,973 - heart_disease_prediction - INFO - Symlink created at ./models\heart_disease_model_latest.pkl
2025-10-25 22:13:08,210 - heart_disease_prediction - INFO - Preprocessing artifacts saved to ./models
2025-10-25 22:13:08,225 - heart_disease_prediction - INFO - Starting plot_model_comparison
2025-10-25 22:13:08,227 - heart_disease_prediction - INFO - Creating model comparison plots
2025-10-25 22:13:11,692 - heart_disease_prediction - INFO - Model comparison plots saved
2025-10-25 22:13:11,693 - heart_disease_prediction - INFO - Completed plot_model_comparison successfully
2025-10-25 22:13:11,693 - heart_disease_prediction - INFO - Starting plot_feature_importance
2025-10-25 22:13:11,695 - heart_disease_prediction - INFO - Creating feature importance plots
2025-10-25 22:13:14,388 - heart_disease_prediction - INFO - Feature importance plots saved
2025-10-25 22:13:14,388 - heart_disease_prediction - INFO - Completed plot_feature_importance successfully
2025-10-25 22:13:14,388 - heart_disease_prediction - INFO - Final visualizations generated
2025-10-25 22:13:14,437 - heart_disease_prediction - INFO - Summary report saved to ./outputs\pipeline_summary.json
2025-10-25 22:13:14,438 - heart_disease_prediction - INFO - Complete ML pipeline finished successfully
2025-10-25 22:13:14,777 - heart_disease_prediction - INFO - Completed run_complete_pipeline successfully
